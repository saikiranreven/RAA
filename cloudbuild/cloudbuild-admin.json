{
  "steps": [
    {
      "name": "gcr.io/cloud-builders/gcloud",
      "args": ["app", "deploy", "Admin/app.yaml", "--quiet"]
    },
    {
      "name": "gcr.io/cloud-builders/gcloud",
      "dir": "cloud_functions",
      "args": [
        "functions", "deploy", "update_inventory_on_order",
        "--gen2",
        "--runtime", "python310",
        "--region", "us-central1",
        "--entry-point", "update_inventory_on_order",
        "--trigger-event-filters", "type=google.cloud.firestore.document.v1.created",
        "--trigger-event-filters", "resource=projects/$PROJECT_ID/databases/(default)/documents/orders/{orderId}",
        "--source", ".",
        "--service-account", "user-app@$PROJECT_ID.iam.gserviceaccount.com",
        "--quiet"
      ]
    }
  ],
  "options": {
    "logging": "CLOUD_LOGGING_ONLY"
  }
}
